## 事件流机制

1. 什么是事件流
2. DOM事件流的三阶段

### 事件流
> 事件流所描述的就是从页面中接受事件的顺序。


具有包含关系的元素结构中，当我们点击了最内部元素的同时也触发到了其上层的父元素;如下结构：
```html
<div class="wrap">
    <div class="middle">
      <div class="inner"></div>
    </div>
  </div>
```
#### 事件冒泡

事件冒泡即事件开始时，由最具体的元素接收（也就是事件发生所在的节点），然后逐级传播到较为不具体的节点；

```js
wrap.onclick=function(event){
  console.log('wrap')
}
middle.onclick=function(event){
  console.log('middle',event)
}
inner.onclick=function(){
  console.log('inner')
}
```

执行的顺序为：`inner -> middle -> wrap`

使用场景：事件委托

#### 事件捕获

事件捕获的概念，与事件冒泡正好相反。它认为当某个事件发生时，父元素应该更早接收到事件，具体元素则最后接收到事件；

上例的执行顺序为：`wrap -> middle -> inner`

使用场景：全局监听 比如 onerror事件

### DOM事件流

 DOM事件流的三个阶段：

1. 事件捕获阶段
2. 处于目标阶段
3. 事件冒泡阶段

三个阶段的触发顺序：捕获阶段、目标阶段、冒泡阶段

`addEventListener`方法的第三个参数描述了事件在什么阶段触发；`true`为捕获阶段触发，`false`为冒泡阶段触发

```js
//捕获阶段触发
wrap.addEventListener('click',(event)=>{
  console.log('wrap')
},true)
inner.addEventListener('click',(event)=>{
  console.log('inner')
},true)
//冒泡阶段触发
middle.addEventListener('click',(event)=>{
  event.stopPropagation()
  console.log('middle')
},false)
```
如果目标为`inner`,此时的执行顺序为：`wrap -> inner -> middle`

+ `event.currentTarget`:标识是当事件沿着 DOM 触发时事件的当前目标。它总是指向事件绑定的元素;
+ `event.target`:指向事件触发的元素
+ `event.stopPropagation()`:阻止事件`传播` 
+ `event.preventDefault()`:阻止默认行为

**ie低版本浏览器**

事件对象在window.event上

+ pageX、pageY有兼容问题 
    【解决】在clientX或clientY的基础上累加窗口的scrollLeft或scrollTop
+ e.target有兼容问题 
    【解决】e.target=e.target||e.srcElement
+ 阻止默认行为兼容问题 
    【解决】e.preventDefault?e.preventDefault:e.returnValue=false
+ 阻止事件传播兼容问题 
    【解决】e.stopPropagation?e.stopPropagation():e.cancelBubble=true



